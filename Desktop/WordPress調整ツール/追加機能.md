# 機能要件ドキュメント：WordPress記事品質チェックツール

## 1. 概要

### 1.1 機能名
WordPress記事品質チェック＆リライト提案機能

### 1.2 目的
WordPressに公開されている記事の中から品質改善が必要な記事を自動抽出し、適切なリライトを促すことでサイト全体の信頼性向上に貢献する。

## 2. 機能要件

### 2.1 主要機能

#### 2.1.1 記事取得機能
- WordPress REST APIを使用した記事一覧取得
- ページネーション対応（大量記事対応）
- カテゴリー・タグによるフィルタリング機能
- 下書き記事の除外

#### 2.1.2 品質チェック機能

**第1段階：AI文章検出**
- textlint-rule-preset-ai-writing（https://github.com/textlint-ja/textlint-rule-preset-ai-writing）による自動検出
- 箇条書きの過剰使用検出
- AI特有の文章パターン検出

**第2段階：詳細分析（Gemini 2.5 Flash使用）**
- 誤情報のチェック
- 情報の最新性チェック
- 文章の論理的整合性チェック
- SEO要素のチェック
  - メタディスクリプションの適切性
  - 見出し構造（H1-H3）の階層性
  - リンク切れチェック
- 読みやすさの評価
  - 1文の長さの適切性
  - 専門用語の説明有無
  - 画像alt属性の有無

#### 2.1.3 優先度スコアリング
```
優先度スコア = (古さスコア × 0.3) + 
               (AI文章スコア × 0.3) + 
               (誤情報リスク × 0.4)
```
※アクセス数データが取得可能な場合は重み付けに追加

#### 2.1.4 レポート生成機能
- CSV形式での出力
- 出力項目：
  - 記事ID
  - タイトル
  - URL
  - 総合スコア
  - textlint検出結果
  - AI分析結果詳細
  - リライト推奨理由
  - 優先度
  - 最終更新日
  - カテゴリー

### 2.2 ユーザーインターフェース要件

#### 2.2.1 入力画面
- チェック対象設定
  - カテゴリー選択
  - 除外記事の指定
  - スコア閾値設定

#### 2.2.2 処理中画面
- プログレスバー表示
- 処理中の記事タイトル表示
- キャンセルボタン

#### 2.2.3 結果表示画面
- サマリー表示（総記事数、要改善記事数など）
- 問題記事のリスト表示（優先度順）
- CSVダウンロードボタン
- 個別記事の詳細確認機能

## 3. 技術仕様

### 3.1 使用技術
- **AI文章検出**: textlint-rule-preset-ai-writing
- **AI分析**: Gemini 2.5 Flash API
- **記事取得**: WordPress REST API v2

### 3.2 API連携仕様

#### WordPress REST API
```javascript
// エンドポイント例
GET /wp-json/wp/v2/posts?per_page=100&page=1
```

#### Gemini API
```javascript
// 分析リクエスト例
{
  model: "gemini-2.5-flash",
  prompt: "以下の記事の品質を分析してください...",
  max_tokens: 65,535
}
```

### 3.3 処理フロー
```
1. ユーザーが認証情報入力
2. WordPress記事一覧取得
3. 各記事に対して：
   a. textlintでAI文章チェック
   b. Gemini APIで詳細分析
   c. スコア計算
4. 結果集計
5. CSVファイル生成・ダウンロード

6. CSVファイル生成後・エクスポートされたCSVファイルのインポート
7. 自動リライト提案機能
- 問題箇所の具体的な修正案を生成
- Before/After の比較プレビュー
- 一括承認・個別編集の選択
```

## 5. 非機能要件

### 5.1 性能要件
- 100記事の処理：約5-10分以内
- メモリ使用量：最大500MB以内
- ブラウザタブのフリーズ防止（非同期処理）

### 5.2 互換性
- 対応ブラウザ：Chrome, Firefox, Safari, Edge（最新版）
- WordPress バージョン：5.0以降
- レスポンシブデザイン対応

### 5.3 エラーハンドリング
- API接続エラーの適切な表示
- レート制限への対応（リトライ機能）
- 部分的な失敗時の継続処理オプション

## 6. 制約事項

### 6.2 機能的制約
- リアルタイム監視は非対応
- 自動実行（定期実行）は非対応
- 過去の実行履歴は保存しない（ユーザーがダウンロードしたCSVファイルをインポートし、下記の記録を読み込めるようにする。）
